---
title: CTFshow 红包题第九弹 SSRF
swiper_index: 2
categories:
    -网络安全
tags:
  - ssrf
  - ctfshow
  - gopher
abbrlink: 22275
date: 2022-12-8 00:30:00
updated: 2022-12-8 00:30:00
---

{% p h1, CTFshow 红包题第九弹 %}
{% p h1,   %}

首页
![code](https://source.bugcarrot.top/articles/cfsweb/hongbaoti9/1.png)<br>

老规矩目录扫一下F12看一下，无果，burp抓个包
![code](https://source.bugcarrot.top/articles/cfsweb/hongbaoti9/2.png)<br>

疑似ssrf，127.0.0.1测一下,能行
![code](https://source.bugcarrot.top/articles/cfsweb/hongbaoti9/3.png)<br>

看看file协议能不能用
![code](https://source.bugcarrot.top/articles/cfsweb/hongbaoti9/4.png)<br>

不行，想起了提示mysql，尝试用gopher攻击mysql，先用gopherus生成payload，写马
![code](https://source.bugcarrot.top/articles/cfsweb/hongbaoti9/5.png)<br>

最后
![code](https://source.bugcarrot.top/articles/cfsweb/hongbaoti9/6.png)<br>

**补充知识点**
{% span left h3 red, 补充知识点 %}

{% tip info %}Gopher是Internet上一个非常有名的信息查找系统，它将Internet上的文件组织成某种索引，很方便地将用户从Internet的一处带到另一处。在WWW出现之前，Gopher是Internet上最主要的信息检索工具，Gopher站点也是最主要的站点，使用tcp70端口。但在WWW出现后，Gopher失去了昔日的辉煌。现在它基本过时，人们很少再使用它
{% endtip %}

gopher协议支持发出GET、POST请求：可以先截获get请求包和post请求包，在构成符合gopher协议的请求。gopher协议是ssrf利用中最强大的协议
gopher协议格式：   URL:gopher://\&lt;host&gt;:&lt;port&gt;/&lt;gopher-path&gt;_后接上TCP数据流

* gopher的默认端口是70
* 如果发起post请求,回车换行需要使用%0d%0,如果多个参数,参数之间的&也需要进行URL编码

参考文章： https://blog.csdn.net/qq_60115503/article/details/124407499

