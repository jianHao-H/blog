---
title: ctfshow - 无数字字母webshell（自增法）
swiper_index: 3
categories:
    -网络安全
tags:
  - php
  - ctfshow
  - RCE
abbrlink: 22275
date: 2022-11-30 20:30:00
updated: 2022-11-30 20:30:00
---

CTFshow 每周大挑战 RCE篇

# RCE1
过滤了括号，不能使用system（），用反引号

php支持一个执行运算符：反引号 \`  \` 这不是单引号，php尝试将反引号中的内容作为shell命令执行，并将其输出信息返回，（即，可以赋给一个变量而不是简单地丢弃到标准输出）。使用反引号运算符 \`  \` 的效果与函数 {%u shell_exec() %}相同
![code](https://source.bugcarrot.top/articles/cfsweb/ctfweekRCE/1.png)

# RCE2
自增法原理：
![code](https://source.bugcarrot.top/articles/cfsweb/ctfweekRCE/2.png)
![code](https://source.bugcarrot.top/articles/cfsweb/ctfweekRCE/3.png)

这时候就需要用到不包含数字和字母的webshell，要怎么得到呢，需要明确思路：将非字母，数字的字符经过各种变换，最后构造出a-z中的任意一个字符

看代码
![code](https://source.bugcarrot.top/articles/cfsweb/ctfweekRCE/4.png)

{% tip warning faa-horizontal animated-hover %}这里有一点需要注意，若是[]不拼接空字符串的话，就会是数组类型，数组类型无法自增得到别的字符{% endtip %}
![code](https://source.bugcarrot.top/articles/cfsweb/ctfweekRCE/5.png)
![code](https://source.bugcarrot.top/articles/cfsweb/ctfweekRCE/6.png)

区别就出来了
![code](https://source.bugcarrot.top/articles/cfsweb/ctfweekRCE/7.png)
![code](https://source.bugcarrot.top/articles/cfsweb/ctfweekRCE/8.png)

看题目：
![code](https://source.bugcarrot.top/articles/cfsweb/ctfweekRCE/9.png)

需要构造payload：$_GET[_]($_GET[__])  套娃传参，这样GET传两个参数，前一个传函数名后一个传命令
![code](https://source.bugcarrot.top/articles/cfsweb/ctfweekRCE/10.png)
![code](https://source.bugcarrot.top/articles/cfsweb/ctfweekRCE/11.png)

# RCE3

比起上一题增加了一个参数长度的限制，但是能用0和1
![code](https://source.bugcarrot.top/articles/cfsweb/ctfweekRCE/13.png)

注意！新用法  NAN，由于N离OPST更近，所以选择构造payload   $_POST($_POST[''])
![code](https://source.bugcarrot.top/articles/cfsweb/ctfweekRCE/14.png)

自己写了个复杂的算法，结果长度大于105了，有更好的算法
![code](https://source.bugcarrot.top/articles/cfsweb/ctfweekRCE/15.png)

一边自增一边赋值，只需要两个变量
![code](https://source.bugcarrot.top/articles/cfsweb/ctfweekRCE/16.png)
![code](https://source.bugcarrot.top/articles/cfsweb/ctfweekRCE/17.png)

# RCE4
又减少了字符长度，且1还不能用,上代码
![code](https://source.bugcarrot.top/articles/cfsweb/ctfweekRCE/18.png)

# RCE5
{% hideBlock 点我预览, skyblue %}
第五关还没搞清楚，找时间再补上 -_-
{% endhideBlock %}


